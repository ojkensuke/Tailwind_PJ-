<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="src/output.css">
</head>
<body>

<div class="min-h-screen bg-gray-50 p-4">
  <h1 class="text-2xl mb-4">シンプル習慣化アプリ</h1>
  <p>確実に達成したいことだけ追加しよう！</p>

  <!-- Today Block -->
  <div class="bg-white rounded-xl">
    <p class="text-sm text-gray-500">Today</p>


<div class="p-4 space-y-6">

  <!-- カテゴリ追加ボタン -->
  <button id="addCategoryBtn" 
    class="w-full py-3 bg-blue-500 text-white rounded-xl active:scale-95 transition">
    ＋ カテゴリを追加
  </button>

  <!-- カテゴリが並ぶエリア -->
  <div id="categoryArea" class="space-y-6"></div>

</div>



   

 







    
    
    <button id="todayBtn" class="mt-2 w-full py-3 rounded-lg 
      bg-blue-500 text-white text-center font-medium">
      完了する
    </button>
    <p class="text-gray-600 mt-3">連続達成：<span id="streak">0</span>日</p>
  </div>

  <!-- Progress Bar -->
  <div class="bg-white rounded-xl p-4 shadow-sm mb-4">
    <p class="text-sm text-gray-500">Progress</p>
    <div class="mt-3 h-3 bg-gray-200 rounded-full">
      <div id="progress" class="h-3 bg-blue-500 rounded-full" style="width: 60%;"></div>
    </div>
    <p class="text-gray-600 mt-3">次のレベルまで：あと <span id="nextLevel">3</span> 日</p>
  </div>

  <!-- Calendar (30 circles) -->
  <div class="bg-white rounded-xl p-4 shadow-sm">
    <p class="text-sm text-gray-500">Last 30 days</p>
    <div id="calendar" class="grid grid-cols-7 gap-2 mt-3"></div>
  </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>

$(function () {
  let tasks = JSON.parse(localStorage.getItem("tasks")) || {};

  // 初期反映
  $(".task-btn").each(function(){
    const key = $(this).data("task");
    if (tasks[key]) {
      $(this).addClass("bg-blue-500 border-blue-500 text-white translate-x-6");
    }
  });

  // 클릭
  $(".task-btn").on("click", function(){
    const key = $(this).data("task");

    // 状態トグル
    const isCompleted = $(this).toggleClass("bg-blue-500 border-blue-500 text-white translate-x-6").hasClass("bg-blue-500");

    // 保存
    tasks[key] = isCompleted;
    localStorage.setItem("tasks", JSON.stringify(tasks));
  });
});



     $(function () {

  // ----------------------------
  // 初期データ読み込み
  // ----------------------------
  let data = JSON.parse(localStorage.getItem("habitData")) || {
    categories: []
  };

  // ----------------------------
  // HTML生成：カテゴリ＆タスク
  // ----------------------------
  function render() {
    $("#categoryArea").empty();

    data.categories.forEach((cat, catIndex) => {
      const catHtml = $(`
        <div class="space-y-2">
          <h2 class="text-gray-600 text-md font-semibold flex justify-between">
            <span>▼ ${cat.name}</span>
            <button class="text-red-400 text-sm delete-cat" data-index="${catIndex}">削除</button>
          </h2>

          <div class="space-y-2" id="cat-${catIndex}">
          </div>

          <button class="add-task-btn text-blue-500 text-sm" data-index="${catIndex}">
            ＋ タスクを追加
          </button>
        </div>
      `);

      $("#categoryArea").append(catHtml);

      // 各タスク描画
      cat.tasks.forEach((task, taskIndex) => {
        $(`#cat-${catIndex}`).append(`
          <div class="flex items-center justify-between bg-white rounded-xl p-3 shadow-sm">
            <span class="text-gray-800">${task.label}</span>

            <button 
              class="task-btn relative w-10 h-10 rounded-full border border-gray-300
              flex items-center justify-center transition overflow-hidden active:scale-95
              ${task.done ? 'bg-blue-500 border-blue-500 text-white' : 'text-transparent'}"
              data-cat="${catIndex}" data-task="${taskIndex}">
              ✓
            </button>
          </div>
        `);
      });
    });
  }

  render();

  // ----------------------------
  // タスク完了切替
  // ----------------------------
  $(document).on("click", ".task-btn", function () {
    const catIdx = $(this).data("cat");
    const taskIdx = $(this).data("task");

    const task = data.categories[catIdx].tasks[taskIdx];
    task.done = !task.done;

    $(this).toggleClass("bg-blue-500 border-blue-500 text-white");

    localStorage.setItem("habitData", JSON.stringify(data));
  });

  // ----------------------------
  // カテゴリ追加
  // ----------------------------
  $("#addCategoryBtn").on("click", function () {
    const name = prompt("カテゴリ名を入力");
    if (!name) return;

    data.categories.push({
      name,
      tasks: []
    });

    localStorage.setItem("habitData", JSON.stringify(data));
    render();
  });

  // ----------------------------
  // タスク追加
  // ----------------------------
  $(document).on("click", ".add-task-btn", function () {
    const catIdx = $(this).data("index");
    const label = prompt("タスク名を入力");
    if (!label) return;

    data.categories[catIdx].tasks.push({
      id: Date.now(),
      label,
      done: false
    });

    localStorage.setItem("habitData", JSON.stringify(data));
    render();
  });

  // ----------------------------
  // カテゴリ削除（任意）
  // ----------------------------
  $(document).on("click", ".delete-cat", function () {
    const index = $(this).data("index");
    if (confirm("削除しますか？")) {
      data.categories.splice(index, 1);
      localStorage.setItem("habitData", JSON.stringify(data));
      render();
    }
  });

});

        

    </script>
</body>
</html>